# Prompt Generation Flow

**Type:** Feature Diagram
**Last Updated:** 2025-11-05
**Related Files:**
- `src/prompt-templates.ts`
- `src/tuning-presets.ts`
- `src/platform-presets.ts`
- `src/index.ts`

## Purpose

Illustrates how user inputs are transformed into a comprehensive AI prompt that generates diverse website design sketches, enabling users to receive 5 unique design variations tailored to their specific needs.

## Diagram

```mermaid
graph TD
    subgraph "Front-Stage: User Experience"
        A[User provides:<br/>Website Type & Page Type] -->|"e.g., 'shoe marketplace' + 'home'"| B[Optional Customization:<br/>Tuning/Platform/Reference]
        B -->|"User sees complete prompt"| C[User Decision:<br/>Preview or Execute]
        C -->|"--execute flag"| D[5 Unique Design Sketches<br/>Generated by Gemini]
        D -->|"Visual variety enables<br/>design exploration"| E[User selects preferred<br/>design direction]
    end

    subgraph "Back-Stage: Prompt Construction"
        F[buildPrompt Function] -->|"Loads page-specific<br/>UI requirements"| G[PAGE_COMPONENTS Lookup]
        G -->|"All essential elements<br/>included for completeness"| H[Element List Assembly]

        F -->|"Applies design<br/>customization"| I{Tuning Specified?}
        I -->|Yes| J[Apply TUNING_PRESETS<br/>prompt modifier]
        I -->|No| K[Use random DESIGN_STYLES<br/>for variety]

        F -->|"Adapts to target<br/>device/context"| L{Platform Specified?}
        L -->|Yes| M[Apply PLATFORM_PRESETS<br/>prompt modifier]
        L -->|No| N[Default: Desktop Website]

        F -->|"Visual inspiration<br/>guides aesthetics"| O{Reference Image?}
        O -->|Yes| P[Add reference path<br/>to prompt]
        O -->|No| Q[Skip reference section]

        H --> R[Combine All Sections]
        J --> R
        K --> R
        M --> R
        N --> R
        P --> R
        Q --> R

        R -->|"5 layout approaches<br/>create structural variety"| S[Add Layout Variations]
        S -->|"5 presentation formats<br/>ensure visual diversity"| T[Add Presentation Formats]
        T -->|"Naming convention<br/>organizes outputs"| U[Add File Naming Scheme]
        U -->|"Complete, executable<br/>AI prompt"| V[Final Prompt String]
    end

    V -.->|"Powers design<br/>generation"| C

    style A fill:#E8F5E9
    style D fill:#E8F5E9
    style E fill:#E8F5E9
    style F fill:#FFF3E0
    style R fill:#FFF3E0
    style V fill:#FFF3E0

    classDef userImpact fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
    classDef technical fill:#FFF3E0,stroke:#FF9800,stroke-width:2px
```

## Key Insights

**User Impact:**
- Users get **5 completely different design variations** from a single prompt, accelerating design exploration
- **Tuning presets** (15 options) let users quickly apply consistent aesthetic directions without design expertise
- **Platform presets** (10 options) automatically adapt designs for mobile, watch, TV, VR, etc.
- **Reference images** enable users to communicate visual preferences when words fall short
- **File naming convention** automatically organizes outputs by type, platform, tuning, and timestamp

**Technical Enablers:**
- `buildPrompt()` orchestrates 7 distinct sections into a cohesive AI prompt
- **PAGE_COMPONENTS** ensures all page-appropriate UI elements are included
- **Randomization** of design styles and presentation formats creates natural variety
- **Conditional logic** adapts prompt structure based on user customization choices
- **Modifier system** allows both preset and custom tuning/platform directions

## Change History

- **2025-11-05:** Initial diagram created showing prompt generation flow with DDD principles
